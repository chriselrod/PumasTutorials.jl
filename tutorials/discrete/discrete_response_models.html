<!DOCTYPE html>
<HTML lang = "en">
<HEAD>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>Discrete Response Models</title>
  

  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},
      TeX: { equationNumbers: { autoNumber: "AMS" } }
    });
  </script>

  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script>

  
<style>
pre.hljl {
    border: 1px solid #ccc;
    margin: 5px;
    padding: 5px;
    overflow-x: auto;
    color: rgb(68,68,68); background-color: rgb(251,251,251); }
pre.hljl > span.hljl-t { }
pre.hljl > span.hljl-w { }
pre.hljl > span.hljl-e { }
pre.hljl > span.hljl-eB { }
pre.hljl > span.hljl-o { }
pre.hljl > span.hljl-k { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kc { color: rgb(59,151,46); font-style: italic; }
pre.hljl > span.hljl-kd { color: rgb(214,102,97); font-style: italic; }
pre.hljl > span.hljl-kn { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kp { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kr { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-kt { color: rgb(148,91,176); font-weight: bold; }
pre.hljl > span.hljl-n { }
pre.hljl > span.hljl-na { }
pre.hljl > span.hljl-nb { }
pre.hljl > span.hljl-nbp { }
pre.hljl > span.hljl-nc { }
pre.hljl > span.hljl-ncB { }
pre.hljl > span.hljl-nd { color: rgb(214,102,97); }
pre.hljl > span.hljl-ne { }
pre.hljl > span.hljl-neB { }
pre.hljl > span.hljl-nf { color: rgb(66,102,213); }
pre.hljl > span.hljl-nfm { color: rgb(66,102,213); }
pre.hljl > span.hljl-np { }
pre.hljl > span.hljl-nl { }
pre.hljl > span.hljl-nn { }
pre.hljl > span.hljl-no { }
pre.hljl > span.hljl-nt { }
pre.hljl > span.hljl-nv { }
pre.hljl > span.hljl-nvc { }
pre.hljl > span.hljl-nvg { }
pre.hljl > span.hljl-nvi { }
pre.hljl > span.hljl-nvm { }
pre.hljl > span.hljl-l { }
pre.hljl > span.hljl-ld { color: rgb(148,91,176); font-style: italic; }
pre.hljl > span.hljl-s { color: rgb(201,61,57); }
pre.hljl > span.hljl-sa { color: rgb(201,61,57); }
pre.hljl > span.hljl-sb { color: rgb(201,61,57); }
pre.hljl > span.hljl-sc { color: rgb(201,61,57); }
pre.hljl > span.hljl-sd { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdB { color: rgb(201,61,57); }
pre.hljl > span.hljl-sdC { color: rgb(201,61,57); }
pre.hljl > span.hljl-se { color: rgb(59,151,46); }
pre.hljl > span.hljl-sh { color: rgb(201,61,57); }
pre.hljl > span.hljl-si { }
pre.hljl > span.hljl-so { color: rgb(201,61,57); }
pre.hljl > span.hljl-sr { color: rgb(201,61,57); }
pre.hljl > span.hljl-ss { color: rgb(201,61,57); }
pre.hljl > span.hljl-ssB { color: rgb(201,61,57); }
pre.hljl > span.hljl-nB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nbB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nfB { color: rgb(59,151,46); }
pre.hljl > span.hljl-nh { color: rgb(59,151,46); }
pre.hljl > span.hljl-ni { color: rgb(59,151,46); }
pre.hljl > span.hljl-nil { color: rgb(59,151,46); }
pre.hljl > span.hljl-noB { color: rgb(59,151,46); }
pre.hljl > span.hljl-oB { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-ow { color: rgb(102,102,102); font-weight: bold; }
pre.hljl > span.hljl-p { }
pre.hljl > span.hljl-c { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-ch { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cm { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cp { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cpB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-cs { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-csB { color: rgb(153,153,119); font-style: italic; }
pre.hljl > span.hljl-g { }
pre.hljl > span.hljl-gd { }
pre.hljl > span.hljl-ge { }
pre.hljl > span.hljl-geB { }
pre.hljl > span.hljl-gh { }
pre.hljl > span.hljl-gi { }
pre.hljl > span.hljl-go { }
pre.hljl > span.hljl-gp { }
pre.hljl > span.hljl-gs { }
pre.hljl > span.hljl-gsB { }
pre.hljl > span.hljl-gt { }
</style>



  <style type="text/css">
  @font-face {
  font-style: normal;
  font-weight: 300;
}
@font-face {
  font-style: normal;
  font-weight: 400;
}
@font-face {
  font-style: normal;
  font-weight: 600;
}
html {
  font-family: sans-serif; /* 1 */
  -ms-text-size-adjust: 100%; /* 2 */
  -webkit-text-size-adjust: 100%; /* 2 */
}
body {
  margin: 0;
}
article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
menu,
nav,
section,
summary {
  display: block;
}
audio,
canvas,
progress,
video {
  display: inline-block; /* 1 */
  vertical-align: baseline; /* 2 */
}
audio:not([controls]) {
  display: none;
  height: 0;
}
[hidden],
template {
  display: none;
}
a:active,
a:hover {
  outline: 0;
}
abbr[title] {
  border-bottom: 1px dotted;
}
b,
strong {
  font-weight: bold;
}
dfn {
  font-style: italic;
}
h1 {
  font-size: 2em;
  margin: 0.67em 0;
}
mark {
  background: #ff0;
  color: #000;
}
small {
  font-size: 80%;
}
sub,
sup {
  font-size: 75%;
  line-height: 0;
  position: relative;
  vertical-align: baseline;
}
sup {
  top: -0.5em;
}
sub {
  bottom: -0.25em;
}
img {
  border: 0;
}
svg:not(:root) {
  overflow: hidden;
}
figure {
  margin: 1em 40px;
}
hr {
  -moz-box-sizing: content-box;
  box-sizing: content-box;
  height: 0;
}
pre {
  overflow: auto;
}
code,
kbd,
pre,
samp {
  font-family: monospace, monospace;
  font-size: 1em;
}
button,
input,
optgroup,
select,
textarea {
  color: inherit; /* 1 */
  font: inherit; /* 2 */
  margin: 0; /* 3 */
}
button {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
  -webkit-appearance: button; /* 2 */
  cursor: pointer; /* 3 */
}
button[disabled],
html input[disabled] {
  cursor: default;
}
button::-moz-focus-inner,
input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
input {
  line-height: normal;
}
input[type="checkbox"],
input[type="radio"] {
  box-sizing: border-box; /* 1 */
  padding: 0; /* 2 */
}
input[type="number"]::-webkit-inner-spin-button,
input[type="number"]::-webkit-outer-spin-button {
  height: auto;
}
input[type="search"] {
  -webkit-appearance: textfield; /* 1 */
  -moz-box-sizing: content-box;
  -webkit-box-sizing: content-box; /* 2 */
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
fieldset {
  border: 1px solid #c0c0c0;
  margin: 0 2px;
  padding: 0.35em 0.625em 0.75em;
}
legend {
  border: 0; /* 1 */
  padding: 0; /* 2 */
}
textarea {
  overflow: auto;
}
optgroup {
  font-weight: bold;
}
table {
  font-family: monospace, monospace;
  font-size : 0.8em;
  border-collapse: collapse;
  border-spacing: 0;
}
td,
th {
  padding: 0;
}
thead th {
    border-bottom: 1px solid black;
    background-color: white;
}
tr:nth-child(odd){
  background-color: rgb(248,248,248);
}


/*
* Skeleton V2.0.4
* Copyright 2014, Dave Gamache
* www.getskeleton.com
* Free to use under the MIT license.
* http://www.opensource.org/licenses/mit-license.php
* 12/29/2014
*/
.container {
  position: relative;
  width: 100%;
  max-width: 960px;
  margin: 0 auto;
  padding: 0 20px;
  box-sizing: border-box; }
.column,
.columns {
  width: 100%;
  float: left;
  box-sizing: border-box; }
@media (min-width: 400px) {
  .container {
    width: 85%;
    padding: 0; }
}
@media (min-width: 550px) {
  .container {
    width: 80%; }
  .column,
  .columns {
    margin-left: 4%; }
  .column:first-child,
  .columns:first-child {
    margin-left: 0; }

  .one.column,
  .one.columns                    { width: 4.66666666667%; }
  .two.columns                    { width: 13.3333333333%; }
  .three.columns                  { width: 22%;            }
  .four.columns                   { width: 30.6666666667%; }
  .five.columns                   { width: 39.3333333333%; }
  .six.columns                    { width: 48%;            }
  .seven.columns                  { width: 56.6666666667%; }
  .eight.columns                  { width: 65.3333333333%; }
  .nine.columns                   { width: 74.0%;          }
  .ten.columns                    { width: 82.6666666667%; }
  .eleven.columns                 { width: 91.3333333333%; }
  .twelve.columns                 { width: 100%; margin-left: 0; }

  .one-third.column               { width: 30.6666666667%; }
  .two-thirds.column              { width: 65.3333333333%; }

  .one-half.column                { width: 48%; }

  /* Offsets */
  .offset-by-one.column,
  .offset-by-one.columns          { margin-left: 8.66666666667%; }
  .offset-by-two.column,
  .offset-by-two.columns          { margin-left: 17.3333333333%; }
  .offset-by-three.column,
  .offset-by-three.columns        { margin-left: 26%;            }
  .offset-by-four.column,
  .offset-by-four.columns         { margin-left: 34.6666666667%; }
  .offset-by-five.column,
  .offset-by-five.columns         { margin-left: 43.3333333333%; }
  .offset-by-six.column,
  .offset-by-six.columns          { margin-left: 52%;            }
  .offset-by-seven.column,
  .offset-by-seven.columns        { margin-left: 60.6666666667%; }
  .offset-by-eight.column,
  .offset-by-eight.columns        { margin-left: 69.3333333333%; }
  .offset-by-nine.column,
  .offset-by-nine.columns         { margin-left: 78.0%;          }
  .offset-by-ten.column,
  .offset-by-ten.columns          { margin-left: 86.6666666667%; }
  .offset-by-eleven.column,
  .offset-by-eleven.columns       { margin-left: 95.3333333333%; }

  .offset-by-one-third.column,
  .offset-by-one-third.columns    { margin-left: 34.6666666667%; }
  .offset-by-two-thirds.column,
  .offset-by-two-thirds.columns   { margin-left: 69.3333333333%; }

  .offset-by-one-half.column,
  .offset-by-one-half.columns     { margin-left: 52%; }

}
html {
  font-size: 62.5%; }
body {
  font-size: 1.5em; /* currently ems cause chrome bug misinterpreting rems on body element */
  line-height: 1.6;
  font-weight: 400;
  font-family: "Raleway", "HelveticaNeue", "Helvetica Neue", Helvetica, Arial, sans-serif;
  color: #222; }
h1, h2, h3, h4, h5, h6 {
  margin-top: 0;
  margin-bottom: 2rem;
  font-weight: 300; }
h1 { font-size: 3.6rem; line-height: 1.2;  letter-spacing: -.1rem;}
h2 { font-size: 3.4rem; line-height: 1.25; letter-spacing: -.1rem; }
h3 { font-size: 3.2rem; line-height: 1.3;  letter-spacing: -.1rem; }
h4 { font-size: 2.8rem; line-height: 1.35; letter-spacing: -.08rem; }
h5 { font-size: 2.4rem; line-height: 1.5;  letter-spacing: -.05rem; }
h6 { font-size: 1.5rem; line-height: 1.6;  letter-spacing: 0; }

p {
  margin-top: 0; }
a {
  color: #1EAEDB; }
a:hover {
  color: #0FA0CE; }
.button,
button,
input[type="submit"],
input[type="reset"],
input[type="button"] {
  display: inline-block;
  height: 38px;
  padding: 0 30px;
  color: #555;
  text-align: center;
  font-size: 11px;
  font-weight: 600;
  line-height: 38px;
  letter-spacing: .1rem;
  text-transform: uppercase;
  text-decoration: none;
  white-space: nowrap;
  background-color: transparent;
  border-radius: 4px;
  border: 1px solid #bbb;
  cursor: pointer;
  box-sizing: border-box; }
.button:hover,
button:hover,
input[type="submit"]:hover,
input[type="reset"]:hover,
input[type="button"]:hover,
.button:focus,
button:focus,
input[type="submit"]:focus,
input[type="reset"]:focus,
input[type="button"]:focus {
  color: #333;
  border-color: #888;
  outline: 0; }
.button.button-primary,
button.button-primary,
input[type="submit"].button-primary,
input[type="reset"].button-primary,
input[type="button"].button-primary {
  color: #FFF;
  background-color: #33C3F0;
  border-color: #33C3F0; }
.button.button-primary:hover,
button.button-primary:hover,
input[type="submit"].button-primary:hover,
input[type="reset"].button-primary:hover,
input[type="button"].button-primary:hover,
.button.button-primary:focus,
button.button-primary:focus,
input[type="submit"].button-primary:focus,
input[type="reset"].button-primary:focus,
input[type="button"].button-primary:focus {
  color: #FFF;
  background-color: #1EAEDB;
  border-color: #1EAEDB; }
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea,
select {
  height: 38px;
  padding: 6px 10px; /* The 6px vertically centers text on FF, ignored by Webkit */
  background-color: #fff;
  border: 1px solid #D1D1D1;
  border-radius: 4px;
  box-shadow: none;
  box-sizing: border-box; }
/* Removes awkward default styles on some inputs for iOS */
input[type="email"],
input[type="number"],
input[type="search"],
input[type="text"],
input[type="tel"],
input[type="url"],
input[type="password"],
textarea {
  -webkit-appearance: none;
     -moz-appearance: none;
          appearance: none; }
textarea {
  min-height: 65px;
  padding-top: 6px;
  padding-bottom: 6px; }
input[type="email"]:focus,
input[type="number"]:focus,
input[type="search"]:focus,
input[type="text"]:focus,
input[type="tel"]:focus,
input[type="url"]:focus,
input[type="password"]:focus,
textarea:focus,
select:focus {
  border: 1px solid #33C3F0;
  outline: 0; }
label,
legend {
  display: block;
  margin-bottom: .5rem;
  font-weight: 600; }
fieldset {
  padding: 0;
  border-width: 0; }
input[type="checkbox"],
input[type="radio"] {
  display: inline; }
label > .label-body {
  display: inline-block;
  margin-left: .5rem;
  font-weight: normal; }
ul {
  list-style: circle; }
ol {
  list-style: decimal; }
ul ul,
ul ol,
ol ol,
ol ul {
  margin: 1.5rem 0 1.5rem 3rem;
  font-size: 90%; }
li > p {margin : 0;}
th,
td {
  padding: 12px 15px;
  text-align: left;
  border-bottom: 1px solid #E1E1E1; }
th:first-child,
td:first-child {
  padding-left: 0; }
th:last-child,
td:last-child {
  padding-right: 0; }
button,
.button {
  margin-bottom: 1rem; }
input,
textarea,
select,
fieldset {
  margin-bottom: 1.5rem; }
pre,
blockquote,
dl,
figure,
table,
p,
ul,
ol,
form {
  margin-bottom: 1.0rem; }
.u-full-width {
  width: 100%;
  box-sizing: border-box; }
.u-max-full-width {
  max-width: 100%;
  box-sizing: border-box; }
.u-pull-right {
  float: right; }
.u-pull-left {
  float: left; }
hr {
  margin-top: 3rem;
  margin-bottom: 3.5rem;
  border-width: 0;
  border-top: 1px solid #E1E1E1; }
.container:after,
.row:after,
.u-cf {
  content: "";
  display: table;
  clear: both; }

pre {
  display: block;
  padding: 9.5px;
  margin: 0 0 10px;
  font-size: 13px;
  line-height: 1.42857143;
  word-break: break-all;
  word-wrap: break-word;
  border: 1px solid #ccc;
  border-radius: 4px;
}

pre.hljl {
  margin: 0 0 10px;
  display: block;
  background: #f5f5f5;
  border-radius: 4px;
  padding : 5px;
}

pre.output {
  background: #ffffff;
}

pre.code {
  background: #ffffff;
}

pre.julia-error {
  color : red
}

code,
kbd,
pre,
samp {
  font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
  font-size: 0.9em;
}


@media (min-width: 400px) {}
@media (min-width: 550px) {}
@media (min-width: 750px) {}
@media (min-width: 1000px) {}
@media (min-width: 1200px) {}

h1.title {margin-top : 20px}
img {max-width : 100%}
div.title {text-align: center;}

  </style>
</HEAD>

<BODY>
  <div class ="container">
    <div class = "row">
      <div class = "col-md-12 twelve columns">
        <div class="title">
          <h1 class="title">Discrete Response Models</h1>
          <h5>Vijay Ivaturi, Chris Rackauckas</h5>
          <h5>July 19th, 2019</h5>
        </div>

        <h1>Introduction</h1>
<p>In this tutorial we will go over the simulation of discrete responses. Many pharmacometrics scenarios have observables, such as pain scores or counts, which necessarily have to be discrete. Handling this discreteness can be paramount to getting an appropriate data fit and to properly understand the variation.</p>
<p>Luckily, in Pumas, discrete outputs are handled no differently from the rest of the Pumas toolchain. In Pumas, to have a discrete distribution as output, simply have that your <code>derived</code> or <code>observed</code> variables come from a discrete distribution like a <code>Poisson</code> process.</p>
<h2>Binary Response Example</h2>
<p>First, let&#39;s take a look at a binary response. A binary response is a model which gives an output of 0 or 1 with a probability <code>p</code>. In Pumas, this is represented by a <code>Bernoulli&#40;p&#41;</code> distribution.</p>
<p>To get started, first let&#39;s load <code>Pumas</code> and read in some example data:</p>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>Pumas</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>StatsFuns</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>CSV</span><span class='hljl-t'>
</span><span class='hljl-n'>data</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>read_pumas</span><span class='hljl-p'>(</span><span class='hljl-nf'>example_data</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;pain_remed&quot;</span><span class='hljl-p'>),</span><span class='hljl-t'>
    </span><span class='hljl-n'>cvs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-sc'>:arm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:dose</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:conc</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:painord</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-n'>remed</span><span class='hljl-p'>],</span><span class='hljl-n'>event_data</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Population
  Subjects: 160
  Covariates: arm, dose, conc, painord, remed
  Observables: dv
</pre>


<p>Next let&#39;s implement a model with a binary response. Here, we do not have an <code>@dynamics</code> porition. Pumas will automatically handle this. In our <code>derived</code>, we define a <code>logistic</code> from <a href="https://github.com/JuliaStats/StatsFuns.jl#basic-functions">StatsFuns</a></p>


<pre class='hljl'>
<span class='hljl-n'>binary_model</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@model</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-nd'>@param</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
        </span><span class='hljl-n'>intercept</span><span class='hljl-t'> </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>RealDomain</span><span class='hljl-p'>(</span><span class='hljl-n'>init</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.001</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-n'>tvslope</span><span class='hljl-t'> </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>RealDomain</span><span class='hljl-p'>(</span><span class='hljl-n'>init</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.0001</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-n'>Ω</span><span class='hljl-t'> </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>VectorDomain</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>

    </span><span class='hljl-nd'>@random</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
        </span><span class='hljl-n'>η</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> </span><span class='hljl-nf'>MvNormal</span><span class='hljl-p'>(</span><span class='hljl-n'>Ω</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>

    </span><span class='hljl-nd'>@covariates</span><span class='hljl-t'> </span><span class='hljl-n'>arm</span><span class='hljl-t'> </span><span class='hljl-n'>dose</span><span class='hljl-t'>

    </span><span class='hljl-nd'>@pre</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
        </span><span class='hljl-n'>rx</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>dose</span><span class='hljl-t'> </span><span class='hljl-oB'>&gt;</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'> </span><span class='hljl-oB'>?</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'>
        </span><span class='hljl-n'>slope</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>tvslope</span><span class='hljl-oB'>*</span><span class='hljl-n'>rx</span><span class='hljl-t'>
        </span><span class='hljl-n'>logit</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>intercept</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>slope</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>η</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>

    </span><span class='hljl-nd'>@derived</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
        </span><span class='hljl-n'>pain</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-nf'>logistic</span><span class='hljl-p'>(</span><span class='hljl-n'>logit</span><span class='hljl-p'>)</span><span class='hljl-t'>
        </span><span class='hljl-n'>dv</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-nf'>Bernoulli</span><span class='hljl-p'>(</span><span class='hljl-nf'>logistic</span><span class='hljl-p'>(</span><span class='hljl-n'>logit</span><span class='hljl-p'>))</span><span class='hljl-t'>
    </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
PumasModel
  Parameters: intercept, tvslope, Ω
  Random effects: η
  Covariates: arm, dose
  Dynamical variables: 
  Derived: pain, dv
  Observed: pain, dv
</pre>


<p>Note that we could have alternatively defined our <code>@pre</code> like:</p>



<pre class='hljl'>
<span class='hljl-nd'>@pre</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>logit</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>intercept</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>tvslope</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-n'>dose</span><span class='hljl-t'> </span><span class='hljl-oB'>&gt;</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-t'> </span><span class='hljl-oB'>?</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>:</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>η</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-n'>logit</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>intercept</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>tvslope</span><span class='hljl-oB'>*</span><span class='hljl-nf'>Int</span><span class='hljl-p'>(</span><span class='hljl-n'>dose</span><span class='hljl-t'> </span><span class='hljl-oB'>&gt;</span><span class='hljl-t'> </span><span class='hljl-ni'>0</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>η</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>]</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<p>more directly instead of using <code>logistic</code>.</p>
<p>Now let&#39;s fit our model to the data:</p>


<pre class='hljl'>
<span class='hljl-n'>param</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-t'>
    </span><span class='hljl-n'>intercept</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.001</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-n'>tvslope</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.0001</span><span class='hljl-p'>,</span><span class='hljl-t'>
    </span><span class='hljl-n'>Ω</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>]</span><span class='hljl-t'>
    </span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;intercept &#61; 0.001, tvslope &#61; 0.0001, Ω &#61; &#91;1.0&#93;&#41;
</pre>


<p>Below you can fit the model</p>


<pre class='hljl'>
<span class='hljl-n'>binary_res</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>fit</span><span class='hljl-p'>(</span><span class='hljl-n'>binary_model</span><span class='hljl-p'>,</span><span class='hljl-n'>data</span><span class='hljl-p'>,</span><span class='hljl-n'>param</span><span class='hljl-p'>,</span><span class='hljl-n'>Pumas</span><span class='hljl-oB'>.</span><span class='hljl-nf'>FOCE</span><span class='hljl-p'>())</span>
</pre>


<pre class="output">
Iter     Function value   Gradient norm 
     0     1.120248e&#43;03     8.687534e&#43;01
 * time: 7.796287536621094e-5
     1     1.096053e&#43;03     1.194179e&#43;01
 * time: 0.3010239601135254
     2     1.093887e&#43;03     9.222565e&#43;00
 * time: 0.3726379871368408
     3     1.091202e&#43;03     1.858939e&#43;01
 * time: 0.4506239891052246
     4     1.088686e&#43;03     8.298456e&#43;00
 * time: 0.5278759002685547
     5     1.086917e&#43;03     5.726617e&#43;00
 * time: 0.594749927520752
     6     1.083295e&#43;03     5.877964e&#43;00
 * time: 0.6749918460845947
     7     1.083021e&#43;03     5.153227e-01
 * time: 0.7467060089111328
     8     1.083007e&#43;03     9.666790e-02
 * time: 0.8107340335845947
     9     1.083007e&#43;03     1.384740e-02
 * time: 0.8671529293060303
    10     1.083007e&#43;03     4.180948e-03
 * time: 0.9231469631195068
    11     1.083007e&#43;03     1.092232e-04
 * time: 1.062553882598877
</pre>



<pre class='hljl'>
<span class='hljl-nf'>coeftable</span><span class='hljl-p'>(</span><span class='hljl-n'>binary_res</span><span class='hljl-p'>)</span>
</pre>



<table class="data-frame"><thead><tr><th></th><th>parameter</th><th>estimate</th></tr><tr><th></th><th>String</th><th>Float64</th></tr></thead><tbody><p>3 rows × 2 columns</p><tr><th>1</th><td>intercept</td><td>-1.30854</td></tr><tr><th>2</th><td>tvslope</td><td>1.73894</td></tr><tr><th>3</th><td>Ω₁</td><td>1.5376</td></tr></tbody></table>

<p>and make some inferences</p>


<pre class='hljl'>
<span class='hljl-nf'>infer</span><span class='hljl-p'>(</span><span class='hljl-n'>binary_res</span><span class='hljl-p'>)</span><span class='hljl-t'>  </span><span class='hljl-oB'>|&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>coeftable</span>
</pre>


<pre class="output">
Calculating: variance-covariance matrix. Done.
</pre>


<table class="data-frame"><thead><tr><th></th><th>parameter</th><th>estimate</th><th>se</th><th>ci_lower</th><th>ci_upper</th></tr><tr><th></th><th>String</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>3 rows × 5 columns</p><tr><th>1</th><td>intercept</td><td>-1.30854</td><td>0.302609</td><td>-1.90164</td><td>-0.715439</td></tr><tr><th>2</th><td>tvslope</td><td>1.73894</td><td>0.337549</td><td>1.07735</td><td>2.40052</td></tr><tr><th>3</th><td>Ω₁</td><td>1.5376</td><td>0.118495</td><td>1.30536</td><td>1.76985</td></tr></tbody></table>

<p>and simulate some outputs:</p>


<pre class='hljl'>
<span class='hljl-n'>sim</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>simobs</span><span class='hljl-p'>(</span><span class='hljl-n'>binary_model</span><span class='hljl-p'>,</span><span class='hljl-n'>data</span><span class='hljl-p'>,</span><span class='hljl-nf'>coef</span><span class='hljl-p'>(</span><span class='hljl-n'>binary_res</span><span class='hljl-p'>))</span><span class='hljl-t'>
</span><span class='hljl-n'>simdf</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>DataFrame</span><span class='hljl-p'>(</span><span class='hljl-n'>sim</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>include_events</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-nf'>first</span><span class='hljl-p'>(</span><span class='hljl-n'>simdf</span><span class='hljl-p'>,</span><span class='hljl-ni'>6</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-cs'># Print only the first 6 rows</span>
</pre>



<table class="data-frame"><thead><tr><th></th><th>id</th><th>time</th><th>pain</th><th>dv</th><th>arm</th><th>dose</th><th>conc</th><th>painord</th><th>remed</th></tr><tr><th></th><th>String</th><th>Float64</th><th>Float64?</th><th>Bool?</th><th>Int64</th><th>Int64</th><th>Float64</th><th>Int64</th><th>Int64</th></tr></thead><tbody><p>6 rows × 9 columns</p><tr><th>1</th><td>1</td><td>0.0</td><td>0.744723</td><td>1</td><td>2</td><td>20</td><td>0.0</td><td>3</td><td>0</td></tr><tr><th>2</th><td>1</td><td>0.5</td><td>0.744723</td><td>1</td><td>2</td><td>20</td><td>1.15578</td><td>1</td><td>0</td></tr><tr><th>3</th><td>1</td><td>1.0</td><td>0.744723</td><td>1</td><td>2</td><td>20</td><td>1.37211</td><td>0</td><td>0</td></tr><tr><th>4</th><td>1</td><td>1.5</td><td>0.744723</td><td>1</td><td>2</td><td>20</td><td>1.30058</td><td>0</td><td>0</td></tr><tr><th>5</th><td>1</td><td>2.0</td><td>0.744723</td><td>0</td><td>2</td><td>20</td><td>1.19195</td><td>1</td><td>0</td></tr><tr><th>6</th><td>1</td><td>2.5</td><td>0.744723</td><td>1</td><td>2</td><td>20</td><td>1.13602</td><td>1</td><td>0</td></tr></tbody></table>

<p>Note that now our simulation output for <code>dv</code> is true/false values pulled with probability given by <code>logit</code> dependent on the individual&#39;s random effects.</p>
<h2>Poisson Response Example</h2>
<p>Next let&#39;s use a <code>Poisson</code> counting process in our model. Here we generate a population where everyone is receiving the same doses as a covariate.</p>


<pre class='hljl'>
<span class='hljl-n'>pop</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>Population</span><span class='hljl-p'>(</span><span class='hljl-nf'>map</span><span class='hljl-p'>(</span><span class='hljl-n'>i</span><span class='hljl-t'> </span><span class='hljl-oB'>-&gt;</span><span class='hljl-t'> </span><span class='hljl-nf'>Subject</span><span class='hljl-p'>(</span><span class='hljl-n'>id</span><span class='hljl-oB'>=</span><span class='hljl-n'>i</span><span class='hljl-p'>,</span><span class='hljl-n'>cvs</span><span class='hljl-oB'>=</span><span class='hljl-p'>(</span><span class='hljl-n'>dose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>i</span><span class='hljl-oB'>.*</span><span class='hljl-ni'>10</span><span class='hljl-p'>,),</span><span class='hljl-n'>time</span><span class='hljl-oB'>=</span><span class='hljl-p'>[</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>]),</span><span class='hljl-ni'>1</span><span class='hljl-oB'>:</span><span class='hljl-ni'>10</span><span class='hljl-p'>))</span>
</pre>


<pre class="output">
Population
  Subjects: 10
  Covariates: dose
</pre>


<p>Now we define our model without dynamics, and directly use the dose information to predict the count for some observable <code>dv</code>:</p>


<pre class='hljl'>
<span class='hljl-n'>poisson_model</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@model</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
  </span><span class='hljl-nd'>@param</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>tvbase</span><span class='hljl-t'> </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>RealDomain</span><span class='hljl-p'>(</span><span class='hljl-n'>init</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>lower</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.1</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>d50</span><span class='hljl-t'> </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>RealDomain</span><span class='hljl-p'>(</span><span class='hljl-n'>init</span><span class='hljl-oB'>=</span><span class='hljl-ni'>50</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>lower</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.1</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>Ω</span><span class='hljl-t'>  </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>PSDDomain</span><span class='hljl-p'>(</span><span class='hljl-nf'>fill</span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span><span class='hljl-p'>))</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>

  </span><span class='hljl-nd'>@random</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>η</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> </span><span class='hljl-nf'>MvNormal</span><span class='hljl-p'>(</span><span class='hljl-n'>Ω</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>

 </span><span class='hljl-nd'>@covariates</span><span class='hljl-t'> </span><span class='hljl-n'>dose</span><span class='hljl-t'>

  </span><span class='hljl-nd'>@pre</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>_dose</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>dose</span><span class='hljl-t'>
    </span><span class='hljl-n'>baseline</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>tvbase</span><span class='hljl-oB'>*</span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>η</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>])</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>

  </span><span class='hljl-nd'>@derived</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>dv</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-nf'>Poisson</span><span class='hljl-p'>(</span><span class='hljl-n'>baseline</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-oB'>-</span><span class='hljl-n'>_dose</span><span class='hljl-oB'>/</span><span class='hljl-p'>(</span><span class='hljl-n'>_dose</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>d50</span><span class='hljl-p'>)))</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
PumasModel
  Parameters: tvbase, d50, Ω
  Random effects: η
  Covariates: dose
  Dynamical variables: 
  Derived: dv
  Observed: dv
</pre>


<p>and simulate runs from the model:</p>


<pre class='hljl'>
<span class='hljl-n'>sim</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>simobs</span><span class='hljl-p'>(</span><span class='hljl-n'>poisson_model</span><span class='hljl-p'>,</span><span class='hljl-n'>pop</span><span class='hljl-p'>)</span><span class='hljl-t'>
</span><span class='hljl-n'>simdf</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>DataFrame</span><span class='hljl-p'>(</span><span class='hljl-n'>sim</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>include_events</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span>
</pre>



<table class="data-frame"><thead><tr><th></th><th>id</th><th>time</th><th>dv</th><th>dose</th></tr><tr><th></th><th>String</th><th>Float64</th><th>Int64?</th><th>Int64</th></tr></thead><tbody><p>10 rows × 4 columns</p><tr><th>1</th><td>1</td><td>0.0</td><td>7</td><td>10</td></tr><tr><th>2</th><td>2</td><td>0.0</td><td>2</td><td>20</td></tr><tr><th>3</th><td>3</td><td>0.0</td><td>0</td><td>30</td></tr><tr><th>4</th><td>4</td><td>0.0</td><td>1</td><td>40</td></tr><tr><th>5</th><td>5</td><td>0.0</td><td>0</td><td>50</td></tr><tr><th>6</th><td>6</td><td>0.0</td><td>1</td><td>60</td></tr><tr><th>7</th><td>7</td><td>0.0</td><td>2</td><td>70</td></tr><tr><th>8</th><td>8</td><td>0.0</td><td>1</td><td>80</td></tr><tr><th>9</th><td>9</td><td>0.0</td><td>1</td><td>90</td></tr><tr><th>10</th><td>10</td><td>0.0</td><td>0</td><td>100</td></tr></tbody></table>

<p>Here <code>dv</code> is an integer output probabilistically dependent on the dose.</p>
<p>Let&#39;s read the data back in to re-estimate the model parameters</p>


<pre class='hljl'>
<span class='hljl-n'>poisson_pop</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>read_pumas</span><span class='hljl-p'>(</span><span class='hljl-n'>simdf</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>dvs</span><span class='hljl-oB'>=</span><span class='hljl-p'>[</span><span class='hljl-sc'>:dv</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>cvs</span><span class='hljl-oB'>=</span><span class='hljl-p'>[</span><span class='hljl-sc'>:dose</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>event_data</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Population
  Subjects: 10
  Covariates: dose
  Observables: dv
</pre>



<pre class='hljl'>
<span class='hljl-n'>poisson_res</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>fit</span><span class='hljl-p'>(</span><span class='hljl-n'>poisson_model</span><span class='hljl-p'>,</span><span class='hljl-n'>poisson_pop</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>init_param</span><span class='hljl-p'>(</span><span class='hljl-n'>poisson_model</span><span class='hljl-p'>),</span><span class='hljl-n'>Pumas</span><span class='hljl-oB'>.</span><span class='hljl-nf'>FOCE</span><span class='hljl-p'>())</span>
</pre>


<pre class="output">
Iter     Function value   Gradient norm 
     0     1.561136e&#43;01     1.737832e&#43;00
 * time: 8.797645568847656e-5
     1     1.537409e&#43;01     1.259292e&#43;00
 * time: 0.024461030960083008
     2     1.475006e&#43;01     7.321087e-01
 * time: 0.029873132705688477
     3     1.451004e&#43;01     8.346820e-01
 * time: 0.035249948501586914
     4     1.425805e&#43;01     1.240420e&#43;00
 * time: 0.04040193557739258
     5     1.347424e&#43;01     5.708304e-01
 * time: 0.04581594467163086
     6     1.332712e&#43;01     9.954432e-01
 * time: 0.05096602439880371
     7     1.323107e&#43;01     4.819317e-01
 * time: 0.05548405647277832
     8     1.321391e&#43;01     7.376048e-02
 * time: 0.05997014045715332
     9     1.320504e&#43;01     2.069067e-01
 * time: 0.06585311889648438
    10     1.320200e&#43;01     6.884209e-01
 * time: 0.07038307189941406
    11     1.319144e&#43;01     7.645838e-02
 * time: 0.0745079517364502
    12     1.318679e&#43;01     5.821299e-02
 * time: 0.07999491691589355
    13     1.318215e&#43;01     1.488699e-01
 * time: 0.08614492416381836
    14     1.318052e&#43;01     4.862264e-01
 * time: 0.09056806564331055
    15     1.317451e&#43;01     4.681948e-02
 * time: 0.09487009048461914
    16     1.317165e&#43;01     2.683782e-02
 * time: 0.09940004348754883
    17     1.316910e&#43;01     9.697082e-02
 * time: 0.10497903823852539
    18     1.316868e&#43;01     4.000019e-01
 * time: 0.10905694961547852
    19     1.316485e&#43;01     2.631680e-02
 * time: 0.11299490928649902
    20     1.316334e&#43;01     2.192342e-02
 * time: 0.11698794364929199
    21     1.316168e&#43;01     8.827958e-02
 * time: 0.12398099899291992
    22     1.316061e&#43;01     2.200282e-01
 * time: 0.12912511825561523
    23     1.315896e&#43;01     4.533956e-02
 * time: 0.13368797302246094
    24     1.315780e&#43;01     2.841150e-02
 * time: 0.13812494277954102
    25     1.315741e&#43;01     1.873959e-01
 * time: 0.14280200004577637
    26     1.315650e&#43;01     7.661916e-03
 * time: 0.14717507362365723
    27     1.315605e&#43;01     1.417900e-02
 * time: 0.15126800537109375
    28     1.315565e&#43;01     5.249116e-02
 * time: 0.15626811981201172
    29     1.315533e&#43;01     8.911306e-02
 * time: 0.16237711906433105
    30     1.315492e&#43;01     2.901021e-02
 * time: 0.16750097274780273
    31     1.315464e&#43;01     5.415779e-02
 * time: 0.1721041202545166
    32     1.315439e&#43;01     2.840446e-02
 * time: 0.17646312713623047
    33     1.315422e&#43;01     4.541123e-02
 * time: 0.18070101737976074
    34     1.315398e&#43;01     9.582482e-03
 * time: 0.18597698211669922
    35     1.315392e&#43;01     1.060682e-02
 * time: 0.19257307052612305
    36     1.315386e&#43;01     3.198373e-02
 * time: 0.19817805290222168
    37     1.315381e&#43;01     3.331571e-02
 * time: 0.2026820182800293
    38     1.315370e&#43;01     1.524929e-02
 * time: 0.20714497566223145
    39     1.315364e&#43;01     2.951270e-02
 * time: 0.21124696731567383
    40     1.315355e&#43;01     8.658992e-03
 * time: 0.2151329517364502
    41     1.315354e&#43;01     3.970209e-02
 * time: 0.21904397010803223
    42     1.315348e&#43;01     5.503393e-03
 * time: 0.22254204750061035
    43     1.315345e&#43;01     6.949932e-03
 * time: 0.22632193565368652
    44     1.315343e&#43;01     2.980224e-02
 * time: 0.2301340103149414
    45     1.315340e&#43;01     4.987530e-03
 * time: 0.23392105102539062
    46     1.315339e&#43;01     3.029528e-03
 * time: 0.23789596557617188
    47     1.315337e&#43;01     2.011404e-02
 * time: 0.24164891242980957
    48     1.315336e&#43;01     4.603888e-03
 * time: 0.24491405487060547
    49     1.315335e&#43;01     2.028421e-03
 * time: 0.2481250762939453
    50     1.315334e&#43;01     9.253525e-03
 * time: 0.25151705741882324
    51     1.315334e&#43;01     4.489112e-03
 * time: 0.25464701652526855
    52     1.315333e&#43;01     3.573399e-03
 * time: 0.25812196731567383
    53     1.315333e&#43;01     8.899507e-04
 * time: 0.26140403747558594
</pre>



<pre class='hljl'>
<span class='hljl-nf'>coeftable</span><span class='hljl-p'>(</span><span class='hljl-n'>poisson_res</span><span class='hljl-p'>)</span>
</pre>



<table class="data-frame"><thead><tr><th></th><th>parameter</th><th>estimate</th></tr><tr><th></th><th>String</th><th>Float64</th></tr></thead><tbody><p>3 rows × 2 columns</p><tr><th>1</th><td>tvbase</td><td>514.673</td></tr><tr><th>2</th><td>d50</td><td>0.100036</td></tr><tr><th>3</th><td>Ω₁,₁</td><td>1.45947e-13</td></tr></tbody></table>

<h2>Negative Binomial Example</h2>
<p>Next let&#39;s use a <code>NegativeBinomial</code> counting process in our model. We will use an internal dataset as an example.</p>


<pre class='hljl'>
<span class='hljl-n'>pd_poisson</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>read_pumas</span><span class='hljl-p'>(</span><span class='hljl-nf'>example_data</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;sim_poisson&quot;</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>cvs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-sc'>:dose</span><span class='hljl-p'>],</span><span class='hljl-t'> </span><span class='hljl-n'>event_data</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Population
  Subjects: 20
  Covariates: dose
  Observables: dv
</pre>


<p>Now we define our model without dynamics, and directly use the dose information to predict the count for some observable <code>dv</code>:</p>


<pre class='hljl'>
<span class='hljl-n'>negativebinomial_model</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@model</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
  </span><span class='hljl-nd'>@param</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>θ₁</span><span class='hljl-t'> </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>RealDomain</span><span class='hljl-p'>(</span><span class='hljl-n'>init</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>3.0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>lower</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.1</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>θ₂</span><span class='hljl-t'> </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>RealDomain</span><span class='hljl-p'>(</span><span class='hljl-n'>init</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.5</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>lower</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.1</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>ω</span><span class='hljl-t'>  </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>RealDomain</span><span class='hljl-p'>(</span><span class='hljl-n'>init</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>lower</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>θr</span><span class='hljl-t'>  </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>RealDomain</span><span class='hljl-p'>(</span><span class='hljl-n'>init</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>1.0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>lower</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>

  </span><span class='hljl-nd'>@random</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>η</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> </span><span class='hljl-nf'>Normal</span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ω</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>

  </span><span class='hljl-nd'>@pre</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>baseline</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>θ₁</span><span class='hljl-oB'>*</span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>η</span><span class='hljl-p'>[</span><span class='hljl-ni'>1</span><span class='hljl-p'>])</span><span class='hljl-t'>
    </span><span class='hljl-n'>d50</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>θ₂</span><span class='hljl-t'>
    </span><span class='hljl-n'>dose_d50</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>dose</span><span class='hljl-oB'>/</span><span class='hljl-p'>(</span><span class='hljl-n'>dose</span><span class='hljl-oB'>+</span><span class='hljl-n'>d50</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>r</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>θr</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>

  </span><span class='hljl-nd'>@covariates</span><span class='hljl-t'> </span><span class='hljl-n'>dose</span><span class='hljl-t'>

  </span><span class='hljl-nd'>@vars</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>m</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>baseline</span><span class='hljl-oB'>*</span><span class='hljl-p'>(</span><span class='hljl-ni'>1</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>dose_d50</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>p</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-oB'>/</span><span class='hljl-p'>(</span><span class='hljl-n'>m</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>r</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>

  </span><span class='hljl-nd'>@derived</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>dv</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-nf'>NegativeBinomial</span><span class='hljl-p'>(</span><span class='hljl-n'>r</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>p</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span><span class='hljl-t'>

</span><span class='hljl-n'>param</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>init_param</span><span class='hljl-p'>(</span><span class='hljl-n'>negativebinomial_model</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
&#40;θ₁ &#61; 3.0, θ₂ &#61; 0.5, ω &#61; 1.0, θr &#61; 1.0&#41;
</pre>


<p>and simulate runs from the model:</p>


<pre class='hljl'>
<span class='hljl-n'>sim_negativebinomial</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>simobs</span><span class='hljl-p'>(</span><span class='hljl-n'>negativebinomial_model</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>pd_poisson</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>param</span><span class='hljl-p'>;</span><span class='hljl-t'> </span><span class='hljl-n'>ensemblealg</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>EnsembleSerial</span><span class='hljl-p'>())</span>
</pre>


<pre class="output">
20-element Array&#123;Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tupl
e&#123;Array&#123;Union&#123;Missing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray
&#123;Array&#123;Float64,1&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float6
4&#125;&#125;,1,NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pum
as.Event&#123;Float64,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Fl
oat64,1&#125;,Array&#123;Float64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;
Array&#123;Float64,1&#125;,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;,1&#125;:
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 1
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;1.259619974569784, 1.259619
974569784, 1.259619974569784, 1.259619974569784, 1.259619974569784, 1.25961
9974569784, 1.259619974569784, 1.259619974569784, 1.259619974569784, 1.2596
19974569784  …  0.5248416560707433, 0.5248416560707433, 0.5248416560707433,
 0.5248416560707433, 0.5248416560707433, 0.5248416560707433, 0.524841656070
7433, 0.5248416560707433, 0.5248416560707433, 0.5248416560707433&#93;, p &#61; &#91;0.4
4255229253334655, 0.44255229253334655, 0.44255229253334655, 0.4425522925333
4655, 0.44255229253334655, 0.44255229253334655, 0.44255229253334655, 0.4425
5229253334655, 0.44255229253334655, 0.44255229253334655  …  0.6558057986012
982, 0.6558057986012982, 0.6558057986012982, 0.6558057986012982, 0.65580579
86012982, 0.6558057986012982, 0.6558057986012982, 0.6558057986012982, 0.655
8057986012982, 0.6558057986012982&#93;, dv &#61; &#91;1, 0, 0, 1, 2, 0, 5, 0, 0, 1  …  
1, 0, 0, 0, 1, 1, 0, 0, 0, 0&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 2
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;1.3348955048694797, 1.33489
55048694797, 1.3348955048694797, 1.3348955048694797, 1.3348955048694797, 1.
3348955048694797, 1.3348955048694797, 1.3348955048694797, 1.334895504869479
7, 1.3348955048694797  …  0.5562064603622832, 0.5562064603622832, 0.5562064
603622832, 0.5562064603622832, 0.5562064603622832, 0.5562064603622832, 0.55
62064603622832, 0.5562064603622832, 0.5562064603622832, 0.5562064603622832&#93;
, p &#61; &#91;0.42828469107695666, 0.42828469107695666, 0.42828469107695666, 0.428
28469107695666, 0.42828469107695666, 0.42828469107695666, 0.428284691076956
66, 0.42828469107695666, 0.42828469107695666, 0.42828469107695666  …  0.642
588258994376, 0.642588258994376, 0.642588258994376, 0.642588258994376, 0.64
2588258994376, 0.642588258994376, 0.642588258994376, 0.642588258994376, 0.6
42588258994376, 0.642588258994376&#93;, dv &#61; &#91;1, 3, 0, 0, 1, 0, 1, 0, 0, 0  …  
0, 1, 0, 0, 0, 1, 0, 0, 1, 0&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 3
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;2.0525530560188394, 2.05255
30560188394, 2.0525530560188394, 2.0525530560188394, 2.0525530560188394, 2.
0525530560188394, 2.0525530560188394, 2.0525530560188394, 2.052553056018839
4, 2.0525530560188394  …  0.8552304400078496, 0.8552304400078496, 0.8552304
400078496, 0.8552304400078496, 0.8552304400078496, 0.8552304400078496, 0.85
52304400078496, 0.8552304400078496, 0.8552304400078496, 0.8552304400078496&#93;
, p &#61; &#91;0.327594633622587, 0.327594633622587, 0.327594633622587, 0.327594633
622587, 0.327594633622587, 0.327594633622587, 0.327594633622587, 0.32759463
3622587, 0.327594633622587, 0.327594633622587  …  0.5390165978495743, 0.539
0165978495743, 0.5390165978495743, 0.5390165978495743, 0.5390165978495743, 
0.5390165978495743, 0.5390165978495743, 0.5390165978495743, 0.5390165978495
743, 0.5390165978495743&#93;, dv &#61; &#91;5, 6, 6, 6, 0, 2, 4, 0, 1, 0  …  0, 2, 0, 2
, 0, 1, 2, 1, 0, 1&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 4
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;2.0159099063460872, 2.01590
99063460872, 2.0159099063460872, 2.0159099063460872, 2.0159099063460872, 2.
0159099063460872, 2.0159099063460872, 2.0159099063460872, 2.015909906346087
2, 2.0159099063460872  …  0.8399624609775362, 0.8399624609775362, 0.8399624
609775362, 0.8399624609775362, 0.8399624609775362, 0.8399624609775362, 0.83
99624609775362, 0.8399624609775362, 0.8399624609775362, 0.8399624609775362&#93;
, p &#61; &#91;0.3315748915097884, 0.3315748915097884, 0.3315748915097884, 0.331574
8915097884, 0.3315748915097884, 0.3315748915097884, 0.3315748915097884, 0.3
315748915097884, 0.3315748915097884, 0.3315748915097884  …  0.5434893489450
429, 0.5434893489450429, 0.5434893489450429, 0.5434893489450429, 0.54348934
89450429, 0.5434893489450429, 0.5434893489450429, 0.5434893489450429, 0.543
4893489450429, 0.5434893489450429&#93;, dv &#61; &#91;5, 1, 1, 0, 0, 0, 6, 0, 0, 3  …  
1, 0, 3, 0, 0, 0, 0, 1, 0, 0&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 5
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;3.3527254870587746, 3.35272
54870587746, 3.3527254870587746, 3.3527254870587746, 3.3527254870587746, 3.
3527254870587746, 3.3527254870587746, 3.3527254870587746, 3.352725487058774
6, 3.3527254870587746  …  1.396968952941156, 1.396968952941156, 1.396968952
941156, 1.396968952941156, 1.396968952941156, 1.396968952941156, 1.39696895
2941156, 1.396968952941156, 1.396968952941156, 1.396968952941156&#93;, p &#61; &#91;0.2
2974111346399662, 0.22974111346399662, 0.22974111346399662, 0.2297411134639
9662, 0.22974111346399662, 0.22974111346399662, 0.22974111346399662, 0.2297
4111346399662, 0.22974111346399662, 0.22974111346399662  …  0.4171935555414
5526, 0.41719355554145526, 0.41719355554145526, 0.41719355554145526, 0.4171
9355554145526, 0.41719355554145526, 0.41719355554145526, 0.4171935555414552
6, 0.41719355554145526, 0.41719355554145526&#93;, dv &#61; &#91;10, 1, 2, 1, 1, 0, 0, 9
, 0, 2  …  0, 0, 0, 1, 1, 0, 2, 5, 0, 1&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 6
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;14.066537474453716, 14.0665
37474453716, 14.066537474453716, 14.066537474453716, 14.066537474453716, 14
.066537474453716, 14.066537474453716, 14.066537474453716, 14.06653747445371
6, 14.066537474453716  …  5.861057281022381, 5.861057281022381, 5.861057281
022381, 5.861057281022381, 5.861057281022381, 5.861057281022381, 5.86105728
1022381, 5.861057281022381, 5.861057281022381, 5.861057281022381&#93;, p &#61; &#91;0.0
663722505383579, 0.0663722505383579, 0.0663722505383579, 0.0663722505383579
, 0.0663722505383579, 0.0663722505383579, 0.0663722505383579, 0.06637225053
83579, 0.0663722505383579, 0.0663722505383579  …  0.14575013136327988, 0.14
575013136327988, 0.14575013136327988, 0.14575013136327988, 0.14575013136327
988, 0.14575013136327988, 0.14575013136327988, 0.14575013136327988, 0.14575
013136327988, 0.14575013136327988&#93;, dv &#61; &#91;7, 29, 2, 0, 16, 3, 10, 2, 1, 5  
…  0, 20, 10, 0, 2, 8, 0, 6, 2, 3&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 7
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;12.65213950919152, 12.65213
950919152, 12.65213950919152, 12.65213950919152, 12.65213950919152, 12.6521
3950919152, 12.65213950919152, 12.65213950919152, 12.65213950919152, 12.652
13950919152  …  5.271724795496466, 5.271724795496466, 5.271724795496466, 5.
271724795496466, 5.271724795496466, 5.271724795496466, 5.271724795496466, 5
.271724795496466, 5.271724795496466, 5.271724795496466&#93;, p &#61; &#91;0.07324859223
176955, 0.07324859223176955, 0.07324859223176955, 0.07324859223176955, 0.07
324859223176955, 0.07324859223176955, 0.07324859223176955, 0.07324859223176
955, 0.07324859223176955, 0.07324859223176955  …  0.1594457717146756, 0.159
4457717146756, 0.1594457717146756, 0.1594457717146756, 0.1594457717146756, 
0.1594457717146756, 0.1594457717146756, 0.1594457717146756, 0.1594457717146
756, 0.1594457717146756&#93;, dv &#61; &#91;8, 1, 3, 15, 2, 21, 0, 27, 3, 6  …  5, 6, 4
, 1, 0, 0, 3, 4, 5, 9&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 8
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;2.4421171269100856, 2.44211
71269100856, 2.4421171269100856, 2.4421171269100856, 2.4421171269100856, 2.
4421171269100856, 2.4421171269100856, 2.4421171269100856, 2.442117126910085
6, 2.4421171269100856  …  1.0175488028792024, 1.0175488028792024, 1.0175488
028792024, 1.0175488028792024, 1.0175488028792024, 1.0175488028792024, 1.01
75488028792024, 1.0175488028792024, 1.0175488028792024, 1.0175488028792024&#93;
, p &#61; &#91;0.29051887635726054, 0.29051887635726054, 0.29051887635726054, 0.290
51887635726054, 0.29051887635726054, 0.29051887635726054, 0.290518876357260
54, 0.29051887635726054, 0.29051887635726054, 0.29051887635726054  …  0.495
65095950735893, 0.49565095950735893, 0.49565095950735893, 0.495650959507358
93, 0.49565095950735893, 0.49565095950735893, 0.49565095950735893, 0.495650
95950735893, 0.49565095950735893, 0.49565095950735893&#93;, dv &#61; &#91;3, 0, 4, 8, 0
, 6, 0, 0, 2, 7  …  3, 1, 0, 0, 4, 0, 0, 2, 1, 0&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 9
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;3.0212329515147243, 3.02123
29515147243, 3.0212329515147243, 3.0212329515147243, 3.0212329515147243, 3.
0212329515147243, 3.0212329515147243, 3.0212329515147243, 3.021232951514724
3, 3.0212329515147243  …  1.258847063131135, 1.258847063131135, 1.258847063
131135, 1.258847063131135, 1.258847063131135, 1.258847063131135, 1.25884706
3131135, 1.258847063131135, 1.258847063131135, 1.258847063131135&#93;, p &#61; &#91;0.2
4867994768204574, 0.24867994768204574, 0.24867994768204574, 0.2486799476820
4574, 0.24867994768204574, 0.24867994768204574, 0.24867994768204574, 0.2486
7994768204574, 0.24867994768204574, 0.24867994768204574  …  0.4427037209919
979, 0.4427037209919979, 0.4427037209919979, 0.4427037209919979, 0.44270372
09919979, 0.4427037209919979, 0.4427037209919979, 0.4427037209919979, 0.442
7037209919979, 0.4427037209919979&#93;, dv &#61; &#91;0, 1, 5, 0, 0, 15, 0, 1, 3, 1  … 
 0, 0, 0, 2, 1, 2, 0, 4, 1, 1&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 10
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;0.31677419577761823, 0.3167
7419577761823, 0.31677419577761823, 0.31677419577761823, 0.3167741957776182
3, 0.31677419577761823, 0.31677419577761823, 0.31677419577761823, 0.3167741
9577761823, 0.31677419577761823  …  0.13198924824067426, 0.1319892482406742
6, 0.13198924824067426, 0.13198924824067426, 0.13198924824067426, 0.1319892
4824067426, 0.13198924824067426, 0.13198924824067426, 0.13198924824067426, 
0.13198924824067426&#93;, p &#61; &#91;0.7594316498657175, 0.7594316498657175, 0.759431
6498657175, 0.7594316498657175, 0.7594316498657175, 0.7594316498657175, 0.7
594316498657175, 0.7594316498657175, 0.7594316498657175, 0.7594316498657175
  …  0.8834006167056706, 0.8834006167056706, 0.8834006167056706, 0.88340061
67056706, 0.8834006167056706, 0.8834006167056706, 0.8834006167056706, 0.883
4006167056706, 0.8834006167056706, 0.8834006167056706&#93;, dv &#61; &#91;0, 0, 0, 0, 0
, 1, 1, 0, 1, 0  …  1, 0, 0, 0, 0, 1, 0, 0, 0, 0&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 11
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;7.4502450781710685, 7.45024
50781710685, 7.4502450781710685, 7.4502450781710685, 7.4502450781710685, 7.
4502450781710685, 7.4502450781710685, 7.4502450781710685, 7.450245078171068
5, 7.4502450781710685  …  3.1042687825712783, 3.1042687825712783, 3.1042687
825712783, 3.1042687825712783, 3.1042687825712783, 3.1042687825712783, 3.10
42687825712783, 3.1042687825712783, 3.1042687825712783, 3.1042687825712783&#93;
, p &#61; &#91;0.11833976301861712, 0.11833976301861712, 0.11833976301861712, 0.118
33976301861712, 0.11833976301861712, 0.11833976301861712, 0.118339763018617
12, 0.11833976301861712, 0.11833976301861712, 0.11833976301861712  …  0.243
64876010228337, 0.24364876010228337, 0.24364876010228337, 0.243648760102283
37, 0.24364876010228337, 0.24364876010228337, 0.24364876010228337, 0.243648
76010228337, 0.24364876010228337, 0.24364876010228337&#93;, dv &#61; &#91;8, 1, 3, 2, 1
, 23, 8, 21, 21, 16  …  5, 5, 2, 2, 8, 3, 3, 2, 4, 0&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 12
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;3.70268715330651, 3.7026871
5330651, 3.70268715330651, 3.70268715330651, 3.70268715330651, 3.7026871533
0651, 3.70268715330651, 3.70268715330651, 3.70268715330651, 3.7026871533065
1  …  1.5427863138777125, 1.5427863138777125, 1.5427863138777125, 1.5427863
138777125, 1.5427863138777125, 1.5427863138777125, 1.5427863138777125, 1.54
27863138777125, 1.5427863138777125, 1.5427863138777125&#93;, p &#61; &#91;0.21264438126
548335, 0.21264438126548335, 0.21264438126548335, 0.21264438126548335, 0.21
264438126548335, 0.21264438126548335, 0.21264438126548335, 0.21264438126548
335, 0.21264438126548335, 0.21264438126548335  …  0.39326938112822163, 0.39
326938112822163, 0.39326938112822163, 0.39326938112822163, 0.39326938112822
163, 0.39326938112822163, 0.39326938112822163, 0.39326938112822163, 0.39326
938112822163, 0.39326938112822163&#93;, dv &#61; &#91;15, 5, 3, 2, 0, 4, 0, 16, 9, 0  …
  0, 1, 1, 2, 0, 3, 4, 1, 3, 2&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 13
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;6.796295293208566, 6.796295
293208566, 6.796295293208566, 6.796295293208566, 6.796295293208566, 6.79629
5293208566, 6.796295293208566, 6.796295293208566, 6.796295293208566, 6.7962
95293208566  …  2.8317897055035686, 2.8317897055035686, 2.8317897055035686,
 2.8317897055035686, 2.8317897055035686, 2.8317897055035686, 2.831789705503
5686, 2.8317897055035686, 2.8317897055035686, 2.8317897055035686&#93;, p &#61; &#91;0.1
2826604975713407, 0.12826604975713407, 0.12826604975713407, 0.1282660497571
3407, 0.12826604975713407, 0.12826604975713407, 0.12826604975713407, 0.1282
6604975713407, 0.12826604975713407, 0.12826604975713407  …  0.2609746559326
333, 0.2609746559326333, 0.2609746559326333, 0.2609746559326333, 0.26097465
59326333, 0.2609746559326333, 0.2609746559326333, 0.2609746559326333, 0.260
9746559326333, 0.2609746559326333&#93;, dv &#61; &#91;15, 7, 6, 2, 18, 1, 0, 0, 6, 3  …
  6, 3, 0, 6, 2, 1, 1, 6, 5, 21&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 14
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;1.5769958007052876, 1.57699
58007052876, 1.5769958007052876, 1.5769958007052876, 1.5769958007052876, 1.
5769958007052876, 1.5769958007052876, 1.5769958007052876, 1.576995800705287
6, 1.5769958007052876  …  0.657081583627203, 0.657081583627203, 0.657081583
627203, 0.657081583627203, 0.657081583627203, 0.657081583627203, 0.65708158
3627203, 0.657081583627203, 0.657081583627203, 0.657081583627203&#93;, p &#61; &#91;0.3
8804875030309094, 0.38804875030309094, 0.38804875030309094, 0.3880487503030
9094, 0.38804875030309094, 0.38804875030309094, 0.38804875030309094, 0.3880
4875030309094, 0.38804875030309094, 0.38804875030309094  …  0.6034705894269
187, 0.6034705894269187, 0.6034705894269187, 0.6034705894269187, 0.60347058
94269187, 0.6034705894269187, 0.6034705894269187, 0.6034705894269187, 0.603
4705894269187, 0.6034705894269187&#93;, dv &#61; &#91;6, 0, 1, 1, 0, 1, 0, 0, 1, 0  …  
1, 1, 0, 0, 0, 1, 1, 0, 0, 0&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 15
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;2.6129592378023583, 2.61295
92378023583, 2.6129592378023583, 2.6129592378023583, 2.6129592378023583, 2.
6129592378023583, 2.6129592378023583, 2.6129592378023583, 2.612959237802358
3, 2.6129592378023583  …  1.0887330157509825, 1.0887330157509825, 1.0887330
157509825, 1.0887330157509825, 1.0887330157509825, 1.0887330157509825, 1.08
87330157509825, 1.0887330157509825, 1.0887330157509825, 1.0887330157509825&#93;
, p &#61; &#91;0.2767814232546577, 0.2767814232546577, 0.2767814232546577, 0.276781
4232546577, 0.2767814232546577, 0.2767814232546577, 0.2767814232546577, 0.2
767814232546577, 0.2767814232546577, 0.2767814232546577  …  0.4787591293186
221, 0.4787591293186221, 0.4787591293186221, 0.4787591293186221, 0.47875912
93186221, 0.4787591293186221, 0.4787591293186221, 0.4787591293186221, 0.478
7591293186221, 0.4787591293186221&#93;, dv &#61; &#91;10, 1, 0, 2, 5, 4, 4, 2, 1, 8  … 
 1, 0, 0, 1, 7, 0, 2, 0, 5, 0&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 16
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;1.2673731818866565, 1.26737
31818866565, 1.2673731818866565, 1.2673731818866565, 1.2673731818866565, 1.
2673731818866565, 1.2673731818866565, 1.2673731818866565, 1.267373181886656
5, 1.2673731818866565  …  0.5280721591194402, 0.5280721591194402, 0.5280721
591194402, 0.5280721591194402, 0.5280721591194402, 0.5280721591194402, 0.52
80721591194402, 0.5280721591194402, 0.5280721591194402, 0.5280721591194402&#93;
, p &#61; &#91;0.441038999662116, 0.441038999662116, 0.441038999662116, 0.441038999
662116, 0.441038999662116, 0.441038999662116, 0.441038999662116, 0.44103899
9662116, 0.441038999662116, 0.441038999662116  …  0.6544193571174384, 0.654
4193571174384, 0.6544193571174384, 0.6544193571174384, 0.6544193571174384, 
0.6544193571174384, 0.6544193571174384, 0.6544193571174384, 0.6544193571174
384, 0.6544193571174384&#93;, dv &#61; &#91;1, 1, 3, 0, 1, 1, 1, 2, 6, 0  …  1, 0, 0, 0
, 2, 0, 0, 0, 0, 0&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 17
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;1.9298259594240783, 1.92982
59594240783, 1.9298259594240783, 1.9298259594240783, 1.9298259594240783, 1.
9298259594240783, 1.9298259594240783, 1.9298259594240783, 1.929825959424078
3, 1.9298259594240783  …  0.8040941497600326, 0.8040941497600326, 0.8040941
497600326, 0.8040941497600326, 0.8040941497600326, 0.8040941497600326, 0.80
40941497600326, 0.8040941497600326, 0.8040941497600326, 0.8040941497600326&#93;
, p &#61; &#91;0.3413172024035762, 0.3413172024035762, 0.3413172024035762, 0.341317
2024035762, 0.3413172024035762, 0.3413172024035762, 0.3413172024035762, 0.3
413172024035762, 0.3413172024035762, 0.3413172024035762  …  0.5542947967172
405, 0.5542947967172405, 0.5542947967172405, 0.5542947967172405, 0.55429479
67172405, 0.5542947967172405, 0.5542947967172405, 0.5542947967172405, 0.554
2947967172405, 0.5542947967172405&#93;, dv &#61; &#91;0, 0, 1, 5, 0, 0, 2, 4, 0, 0  …  
0, 0, 0, 0, 1, 0, 2, 0, 1, 2&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 18
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;19.72172218743855, 19.72172
218743855, 19.72172218743855, 19.72172218743855, 19.72172218743855, 19.7217
2218743855, 19.72172218743855, 19.72172218743855, 19.72172218743855, 19.721
72218743855  …  8.217384244766063, 8.217384244766063, 8.217384244766063, 8.
217384244766063, 8.217384244766063, 8.217384244766063, 8.217384244766063, 8
.217384244766063, 8.217384244766063, 8.217384244766063&#93;, p &#61; &#91;0.04825853715
026626, 0.04825853715026626, 0.04825853715026626, 0.04825853715026626, 0.04
825853715026626, 0.04825853715026626, 0.04825853715026626, 0.04825853715026
626, 0.04825853715026626, 0.04825853715026626  …  0.10849064913050938, 0.10
849064913050938, 0.10849064913050938, 0.10849064913050938, 0.10849064913050
938, 0.10849064913050938, 0.10849064913050938, 0.10849064913050938, 0.10849
064913050938, 0.10849064913050938&#93;, dv &#61; &#91;40, 15, 29, 26, 53, 12, 16, 12, 9
, 54  …  26, 12, 19, 27, 14, 6, 36, 9, 19, 7&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 19
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;6.67997728517021, 6.6799772
8517021, 6.67997728517021, 6.67997728517021, 6.67997728517021, 6.6799772851
7021, 6.67997728517021, 6.67997728517021, 6.67997728517021, 6.6799772851702
1  …  2.7833238688209208, 2.7833238688209208, 2.7833238688209208, 2.7833238
688209208, 2.7833238688209208, 2.7833238688209208, 2.7833238688209208, 2.78
33238688209208, 2.7833238688209208, 2.7833238688209208&#93;, p &#61; &#91;0.13020871844
64683, 0.1302087184464683, 0.1302087184464683, 0.1302087184464683, 0.130208
7184464683, 0.1302087184464683, 0.1302087184464683, 0.1302087184464683, 0.1
302087184464683, 0.1302087184464683  …  0.2643178418430383, 0.2643178418430
383, 0.2643178418430383, 0.2643178418430383, 0.2643178418430383, 0.26431784
18430383, 0.2643178418430383, 0.2643178418430383, 0.2643178418430383, 0.264
3178418430383&#93;, dv &#61; &#91;1, 1, 1, 4, 8, 1, 4, 1, 11, 3  …  1, 4, 0, 0, 0, 1, 1
, 3, 1, 5&#93;&#41;&#41;
 Pumas.SimulatedObservations&#123;Subject&#123;NamedTuple&#123;&#40;:dv,&#41;,Tuple&#123;Array&#123;Union&#123;Mi
ssing, Float64&#125;,1&#125;&#125;&#125;,Pumas.ConstantInterpolationStructArray&#123;Array&#123;Float64,1
&#125;,StructArrays.StructArray&#123;NamedTuple&#123;&#40;:dose,&#41;,Tuple&#123;Float64&#125;&#125;,1,NamedTuple
&#123;&#40;:dose,&#41;,Tuple&#123;Array&#123;Float64,1&#125;&#125;&#125;,Int64&#125;,Symbol&#125;,Array&#123;Pumas.Event&#123;Float64
,Float64,Float64,Float64,Float64,Float64,Int64&#125;,1&#125;,Array&#123;Float64,1&#125;,Array&#123;F
loat64,1&#125;&#125;,Array&#123;Float64,1&#125;,NamedTuple&#123;&#40;:m, :p, :dv&#41;,Tuple&#123;Array&#123;Float64,1&#125;
,Array&#123;Float64,1&#125;,Array&#123;Int64,1&#125;&#125;&#125;&#125;&#40;Subject
  ID: 20
  Events: 0
  Observables: dv: &#40;n&#61;90&#41;
  Covariates: dose
, &#91;0.0, 1.0, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0  …  80.0, 81.0, 82.0, 8
3.0, 84.0, 85.0, 86.0, 87.0, 88.0, 89.0&#93;, &#40;m &#61; &#91;0.7187738638513437, 0.71877
38638513437, 0.7187738638513437, 0.7187738638513437, 0.7187738638513437, 0.
7187738638513437, 0.7187738638513437, 0.7187738638513437, 0.718773863851343
7, 0.7187738638513437  …  0.2994891099380598, 0.2994891099380598, 0.2994891
099380598, 0.2994891099380598, 0.2994891099380598, 0.2994891099380598, 0.29
94891099380598, 0.2994891099380598, 0.2994891099380598, 0.2994891099380598&#93;
, p &#61; &#91;0.5818101037208289, 0.5818101037208289, 0.5818101037208289, 0.581810
1037208289, 0.5818101037208289, 0.5818101037208289, 0.5818101037208289, 0.5
818101037208289, 0.5818101037208289, 0.5818101037208289  …  0.7695331898915
759, 0.7695331898915759, 0.7695331898915759, 0.7695331898915759, 0.76953318
98915759, 0.7695331898915759, 0.7695331898915759, 0.7695331898915759, 0.769
5331898915759, 0.7695331898915759&#93;, dv &#61; &#91;1, 0, 4, 1, 0, 0, 1, 0, 0, 0  …  
0, 0, 0, 0, 0, 0, 0, 0, 0, 0&#93;&#41;&#41;
</pre>


<p>Here <code>dv</code> is an integer output probabilistically dependent on the dose.</p>
<p>Let&#39;s read the data back in to re-estimate the model parameters</p>


<pre class='hljl'>
<span class='hljl-n'>pd_negativebinomial</span><span class='hljl-t'>  </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>Subject</span><span class='hljl-oB'>.</span><span class='hljl-p'>(</span><span class='hljl-n'>sim_negativebinomial</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Population
  Subjects: 20
  Covariates: dose
  Observables: dv
</pre>


<p>And fit the data</p>


<pre class='hljl'>
<span class='hljl-n'>ngebin_res</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>fit</span><span class='hljl-p'>(</span><span class='hljl-n'>negativebinomial_model</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>pd_negativebinomial</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>param</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>Pumas</span><span class='hljl-oB'>.</span><span class='hljl-nf'>FOCE</span><span class='hljl-p'>())</span>
</pre>


<pre class="output">
Iter     Function value   Gradient norm 
     0     3.471822e&#43;03     3.746129e&#43;00
 * time: 8.893013000488281e-5
     1     3.471733e&#43;03     4.156427e&#43;00
 * time: 0.05030679702758789
     2     3.471625e&#43;03     5.006791e-01
 * time: 0.09161090850830078
     3     3.471617e&#43;03     2.210872e-01
 * time: 0.12087082862854004
     4     3.471616e&#43;03     1.930902e-01
 * time: 0.14271187782287598
     5     3.471616e&#43;03     2.633172e-03
 * time: 0.16118288040161133
     6     3.471616e&#43;03     2.623516e-03
 * time: 0.2525959014892578
     7     3.471616e&#43;03     2.617555e-03
 * time: 0.2819077968597412
     8     3.471616e&#43;03     2.617115e-03
 * time: 0.311460018157959
     9     3.471616e&#43;03     2.616756e-03
 * time: 0.3367187976837158
    10     3.471616e&#43;03     2.616419e-03
 * time: 0.3605778217315674
    11     3.471616e&#43;03     2.616100e-03
 * time: 0.3872199058532715
    12     3.471616e&#43;03     2.615796e-03
 * time: 0.41458892822265625
    13     3.471616e&#43;03     2.615767e-03
 * time: 0.445389986038208
    14     3.471616e&#43;03     2.615738e-03
 * time: 0.4750998020172119
    15     3.471616e&#43;03     2.615709e-03
 * time: 0.5075809955596924
    16     3.471616e&#43;03     2.615680e-03
 * time: 0.5384969711303711
    17     3.471616e&#43;03     2.615678e-03
 * time: 0.5695610046386719
    18     3.471616e&#43;03     2.615675e-03
 * time: 0.6030008792877197
    19     3.471616e&#43;03     2.615672e-03
 * time: 0.635483980178833
    20     3.471616e&#43;03     2.615669e-03
 * time: 0.6679549217224121
    21     3.471616e&#43;03     2.615666e-03
 * time: 0.7631938457489014
    22     3.471616e&#43;03     2.615666e-03
 * time: 0.802452802658081
    23     3.471616e&#43;03     2.615666e-03
 * time: 0.8401579856872559
    24     3.471616e&#43;03     2.615665e-03
 * time: 0.8753769397735596
    25     3.471616e&#43;03     2.615665e-03
 * time: 0.9120078086853027
    26     3.471616e&#43;03     2.615665e-03
 * time: 0.9453978538513184
    27     3.471616e&#43;03     2.615664e-03
 * time: 0.9799258708953857
    28     3.471616e&#43;03     2.615664e-03
 * time: 1.0128288269042969
    29     3.471616e&#43;03     2.615664e-03
 * time: 1.0479328632354736
    30     3.471616e&#43;03     2.615664e-03
 * time: 1.0854179859161377
    31     3.471616e&#43;03     2.615664e-03
 * time: 1.123309850692749
    32     3.471616e&#43;03     2.615664e-03
 * time: 1.1622519493103027
    33     3.471616e&#43;03     2.615664e-03
 * time: 1.1998498439788818
    34     3.471616e&#43;03     2.615664e-03
 * time: 1.2975549697875977
    35     3.471616e&#43;03     2.615664e-03
 * time: 1.340336799621582
    36     3.471616e&#43;03     2.615664e-03
 * time: 1.3782289028167725
    37     3.471616e&#43;03     2.615664e-03
 * time: 1.4188299179077148
    38     3.471616e&#43;03     2.615664e-03
 * time: 1.4592738151550293
    39     3.471616e&#43;03     2.615664e-03
 * time: 1.5052599906921387
    40     3.471616e&#43;03     2.615664e-03
 * time: 1.5530729293823242
</pre>



<pre class='hljl'>
<span class='hljl-nf'>coeftable</span><span class='hljl-p'>(</span><span class='hljl-n'>ngebin_res</span><span class='hljl-p'>)</span>
</pre>



<table class="data-frame"><thead><tr><th></th><th>parameter</th><th>estimate</th></tr><tr><th></th><th>String</th><th>Float64</th></tr></thead><tbody><p>4 rows × 2 columns</p><tr><th>1</th><td>θ₁</td><td>2.83638</td></tr><tr><th>2</th><td>θ₂</td><td>0.508365</td></tr><tr><th>3</th><td>ω</td><td>1.09399</td></tr><tr><th>4</th><td>θr</td><td>0.992797</td></tr></tbody></table>

<p>and make an inference</p>


<pre class='hljl'>
<span class='hljl-nf'>infer</span><span class='hljl-p'>(</span><span class='hljl-n'>ngebin_res</span><span class='hljl-p'>)</span><span class='hljl-t'>  </span><span class='hljl-oB'>|&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>coeftable</span>
</pre>


<pre class="output">
Calculating: variance-covariance matrix. Done.
</pre>


<table class="data-frame"><thead><tr><th></th><th>parameter</th><th>estimate</th><th>se</th><th>ci_lower</th><th>ci_upper</th></tr><tr><th></th><th>String</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>4 rows × 5 columns</p><tr><th>1</th><td>θ₁</td><td>2.83638</td><td>0.685437</td><td>1.49295</td><td>4.17981</td></tr><tr><th>2</th><td>θ₂</td><td>0.508365</td><td>0.0685707</td><td>0.373969</td><td>0.642761</td></tr><tr><th>3</th><td>ω</td><td>1.09399</td><td>0.16032</td><td>0.779767</td><td>1.40821</td></tr><tr><th>4</th><td>θr</td><td>0.992797</td><td>0.0403577</td><td>0.913697</td><td>1.0719</td></tr></tbody></table>

<h2>Ordinal data example</h2>
<p>Next, we look at a simple example for ordinal data. Again, we will use an internal dataset</p>


<pre class='hljl'>
<span class='hljl-n'>df</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>copy</span><span class='hljl-p'>(</span><span class='hljl-n'>CSV</span><span class='hljl-oB'>.</span><span class='hljl-nf'>read</span><span class='hljl-p'>(</span><span class='hljl-nf'>example_data</span><span class='hljl-p'>(</span><span class='hljl-s'>&quot;pain_remed&quot;</span><span class='hljl-p'>)))</span>
</pre>



<table class="data-frame"><thead><tr><th></th><th>id</th><th>arm</th><th>dose</th><th>time</th><th>conc</th><th>painord</th><th>dv</th><th>remed</th></tr><tr><th></th><th>Int64</th><th>Int64</th><th>Int64</th><th>Float64</th><th>Float64</th><th>Int64</th><th>Int64</th><th>Int64</th></tr></thead><tbody><p>1,920 rows × 8 columns</p><tr><th>1</th><td>1</td><td>2</td><td>20</td><td>0.0</td><td>0.0</td><td>3</td><td>0</td><td>0</td></tr><tr><th>2</th><td>1</td><td>2</td><td>20</td><td>0.5</td><td>1.15578</td><td>1</td><td>1</td><td>0</td></tr><tr><th>3</th><td>1</td><td>2</td><td>20</td><td>1.0</td><td>1.37211</td><td>0</td><td>1</td><td>0</td></tr><tr><th>4</th><td>1</td><td>2</td><td>20</td><td>1.5</td><td>1.30058</td><td>0</td><td>1</td><td>0</td></tr><tr><th>5</th><td>1</td><td>2</td><td>20</td><td>2.0</td><td>1.19195</td><td>1</td><td>1</td><td>0</td></tr><tr><th>6</th><td>1</td><td>2</td><td>20</td><td>2.5</td><td>1.13602</td><td>1</td><td>1</td><td>0</td></tr><tr><th>7</th><td>1</td><td>2</td><td>20</td><td>3.0</td><td>0.873224</td><td>0</td><td>1</td><td>0</td></tr><tr><th>8</th><td>1</td><td>2</td><td>20</td><td>4.0</td><td>0.739963</td><td>1</td><td>1</td><td>0</td></tr><tr><th>9</th><td>1</td><td>2</td><td>20</td><td>5.0</td><td>0.600143</td><td>2</td><td>0</td><td>0</td></tr><tr><th>10</th><td>1</td><td>2</td><td>20</td><td>6.0</td><td>0.425624</td><td>1</td><td>1</td><td>0</td></tr><tr><th>11</th><td>1</td><td>2</td><td>20</td><td>7.0</td><td>0.363418</td><td>1</td><td>1</td><td>0</td></tr><tr><th>12</th><td>1</td><td>2</td><td>20</td><td>8.0</td><td>0.304177</td><td>1</td><td>1</td><td>0</td></tr><tr><th>13</th><td>2</td><td>3</td><td>80</td><td>0.0</td><td>0.0</td><td>3</td><td>0</td><td>0</td></tr><tr><th>14</th><td>2</td><td>3</td><td>80</td><td>0.5</td><td>4.93492</td><td>1</td><td>1</td><td>0</td></tr><tr><th>15</th><td>2</td><td>3</td><td>80</td><td>1.0</td><td>4.56849</td><td>0</td><td>1</td><td>0</td></tr><tr><th>16</th><td>2</td><td>3</td><td>80</td><td>1.5</td><td>4.23436</td><td>0</td><td>1</td><td>0</td></tr><tr><th>17</th><td>2</td><td>3</td><td>80</td><td>2.0</td><td>3.35444</td><td>0</td><td>1</td><td>0</td></tr><tr><th>18</th><td>2</td><td>3</td><td>80</td><td>2.5</td><td>2.70046</td><td>1</td><td>1</td><td>0</td></tr><tr><th>19</th><td>2</td><td>3</td><td>80</td><td>3.0</td><td>2.38586</td><td>1</td><td>1</td><td>0</td></tr><tr><th>20</th><td>2</td><td>3</td><td>80</td><td>4.0</td><td>1.84095</td><td>1</td><td>1</td><td>0</td></tr><tr><th>21</th><td>2</td><td>3</td><td>80</td><td>5.0</td><td>1.64535</td><td>1</td><td>1</td><td>0</td></tr><tr><th>22</th><td>2</td><td>3</td><td>80</td><td>6.0</td><td>1.36486</td><td>0</td><td>1</td><td>0</td></tr><tr><th>23</th><td>2</td><td>3</td><td>80</td><td>7.0</td><td>1.20802</td><td>1</td><td>1</td><td>0</td></tr><tr><th>24</th><td>2</td><td>3</td><td>80</td><td>8.0</td><td>0.983679</td><td>0</td><td>1</td><td>0</td></tr><tr><th>&vellip;</th><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td><td>&vellip;</td></tr></tbody></table>

<p>The  dependent variable is coded 0:3 but <code>Categorical</code> distribution in julia starts indexing at 1</p>


<pre class='hljl'>
<span class='hljl-n'>df</span><span class='hljl-oB'>.</span><span class='hljl-n'>painord</span><span class='hljl-t'> </span><span class='hljl-oB'>.+=</span><span class='hljl-t'> </span><span class='hljl-ni'>1</span>
</pre>


<pre class="output">
1920-element Array&#123;Int64,1&#125;:
 4
 2
 1
 1
 2
 2
 1
 2
 3
 2
 ⋮
 4
 3
 2
 3
 4
 4
 4
 3
 4
</pre>


<p>Now, that we made this change, lets read the data into Pumas</p>


<pre class='hljl'>
<span class='hljl-n'>data</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>read_pumas</span><span class='hljl-p'>(</span><span class='hljl-n'>df</span><span class='hljl-p'>,</span><span class='hljl-t'>
  </span><span class='hljl-n'>dvs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-sc'>:painord</span><span class='hljl-p'>],</span><span class='hljl-t'>
  </span><span class='hljl-n'>cvs</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-p'>[</span><span class='hljl-sc'>:arm</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:dose</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:conc</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-sc'>:painord</span><span class='hljl-p'>,</span><span class='hljl-oB'>:</span><span class='hljl-n'>remed</span><span class='hljl-p'>],</span><span class='hljl-t'>
  </span><span class='hljl-n'>event_data</span><span class='hljl-oB'>=</span><span class='hljl-kc'>false</span><span class='hljl-p'>)</span>
</pre>


<pre class="output">
Population
  Subjects: 160
  Covariates: arm, dose, conc, painord, remed
  Observables: painord
</pre>


<p>the ordinal model is below</p>


<pre class='hljl'>
<span class='hljl-n'>ordinal_model</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nd'>@model</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
  </span><span class='hljl-nd'>@param</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>b₁</span><span class='hljl-t'>    </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>RealDomain</span><span class='hljl-p'>(</span><span class='hljl-n'>init</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>2.90692</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>b₂</span><span class='hljl-t'>    </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>RealDomain</span><span class='hljl-p'>(</span><span class='hljl-n'>init</span><span class='hljl-oB'>=-</span><span class='hljl-nfB'>2.97771</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>lower</span><span class='hljl-oB'>=-</span><span class='hljl-ni'>1000000</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>upper</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>b₃</span><span class='hljl-t'>    </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>RealDomain</span><span class='hljl-p'>(</span><span class='hljl-n'>init</span><span class='hljl-oB'>=-</span><span class='hljl-nfB'>2.7541</span><span class='hljl-t'> </span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>lower</span><span class='hljl-oB'>=-</span><span class='hljl-ni'>1000000</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>upper</span><span class='hljl-oB'>=</span><span class='hljl-ni'>1</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>slope</span><span class='hljl-t'> </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>RealDomain</span><span class='hljl-p'>(</span><span class='hljl-n'>init</span><span class='hljl-oB'>=</span><span class='hljl-nfB'>0.01</span><span class='hljl-p'>)</span><span class='hljl-t'>
    </span><span class='hljl-n'>ω</span><span class='hljl-t'>     </span><span class='hljl-oB'>∈</span><span class='hljl-t'> </span><span class='hljl-nf'>RealDomain</span><span class='hljl-p'>(</span><span class='hljl-n'>init</span><span class='hljl-oB'>=</span><span class='hljl-nf'>sqrt</span><span class='hljl-p'>(</span><span class='hljl-nfB'>3.10532</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>lower</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nfB'>0.001</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>

  </span><span class='hljl-nd'>@random</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>η</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> </span><span class='hljl-nf'>Normal</span><span class='hljl-p'>(</span><span class='hljl-nfB'>0.0</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>ω</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>

  </span><span class='hljl-nd'>@covariates</span><span class='hljl-t'> </span><span class='hljl-n'>conc</span><span class='hljl-t'>

  </span><span class='hljl-nd'>@pre</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>effect</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-n'>slope</span><span class='hljl-t'> </span><span class='hljl-oB'>*</span><span class='hljl-t'> </span><span class='hljl-n'>conc</span><span class='hljl-t'>
    </span><span class='hljl-cs'>#Logit of cumulative probabilities</span><span class='hljl-t'>
    </span><span class='hljl-n'>lge₀</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>b₁</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>η</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>effect</span><span class='hljl-t'>
    </span><span class='hljl-n'>lge₁</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>lge₀</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>b₂</span><span class='hljl-t'>
    </span><span class='hljl-n'>lge₂</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>lge₁</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-n'>b₃</span><span class='hljl-t'>

    </span><span class='hljl-cs'>#Probabilities of &gt;=0 and &gt;=1 and &gt;=2</span><span class='hljl-t'>
    </span><span class='hljl-n'>pge₀</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>lge₀</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>1.0</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>lge₀</span><span class='hljl-p'>))</span><span class='hljl-t'>
    </span><span class='hljl-n'>pge₁</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>lge₁</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>1.0</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>lge₁</span><span class='hljl-p'>))</span><span class='hljl-t'>
    </span><span class='hljl-n'>pge₂</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>lge₂</span><span class='hljl-p'>)</span><span class='hljl-t'> </span><span class='hljl-oB'>/</span><span class='hljl-t'> </span><span class='hljl-p'>(</span><span class='hljl-nfB'>1.0</span><span class='hljl-t'> </span><span class='hljl-oB'>+</span><span class='hljl-t'> </span><span class='hljl-nf'>exp</span><span class='hljl-p'>(</span><span class='hljl-n'>lge₂</span><span class='hljl-p'>))</span><span class='hljl-t'>

    </span><span class='hljl-cs'>#Probabilities of Y=0,1,2,3</span><span class='hljl-t'>
    </span><span class='hljl-n'>p₀</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-nfB'>1.0</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>pge₀</span><span class='hljl-t'>
    </span><span class='hljl-n'>p₁</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>pge₀</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>pge₁</span><span class='hljl-t'>
    </span><span class='hljl-n'>p₂</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>pge₁</span><span class='hljl-t'> </span><span class='hljl-oB'>-</span><span class='hljl-t'> </span><span class='hljl-n'>pge₂</span><span class='hljl-t'>
    </span><span class='hljl-n'>p₃</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-n'>pge₂</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>

  </span><span class='hljl-nd'>@derived</span><span class='hljl-t'> </span><span class='hljl-k'>begin</span><span class='hljl-t'>
    </span><span class='hljl-n'>painord</span><span class='hljl-t'> </span><span class='hljl-oB'>~</span><span class='hljl-t'> @</span><span class='hljl-oB'>.</span><span class='hljl-t'> </span><span class='hljl-nf'>Categorical</span><span class='hljl-p'>(</span><span class='hljl-n'>p₀</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>p₁</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>p₂</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>p₃</span><span class='hljl-p'>)</span><span class='hljl-t'>
  </span><span class='hljl-k'>end</span><span class='hljl-t'>
</span><span class='hljl-k'>end</span>
</pre>


<pre class="output">
PumasModel
  Parameters: b₁, b₂, b₃, slope, ω
  Random effects: η
  Covariates: conc
  Dynamical variables: 
  Derived: painord
  Observed: painord
</pre>



<pre class='hljl'>
<span class='hljl-n'>ordinal_res</span><span class='hljl-t'> </span><span class='hljl-oB'>=</span><span class='hljl-t'> </span><span class='hljl-nf'>fit</span><span class='hljl-p'>(</span><span class='hljl-n'>ordinal_model</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-n'>data</span><span class='hljl-p'>,</span><span class='hljl-t'> </span><span class='hljl-nf'>init_param</span><span class='hljl-p'>(</span><span class='hljl-n'>ordinal_model</span><span class='hljl-p'>),</span><span class='hljl-t'> </span><span class='hljl-n'>Pumas</span><span class='hljl-oB'>.</span><span class='hljl-nf'>FOCE</span><span class='hljl-p'>())</span>
</pre>


<pre class="output">
Iter     Function value   Gradient norm 
     0     2.041783e&#43;03     1.964595e&#43;02
 * time: 7.82012939453125e-5
     1     2.003093e&#43;03     3.820730e&#43;01
 * time: 0.22071599960327148
     2     2.002227e&#43;03     1.627452e&#43;01
 * time: 0.4831349849700928
     3     2.001863e&#43;03     5.842769e&#43;01
 * time: 0.6322240829467773
     4     2.000221e&#43;03     1.919622e&#43;01
 * time: 0.892333984375
     5     1.998995e&#43;03     1.015010e&#43;01
 * time: 1.0250589847564697
     6     1.998415e&#43;03     7.972649e&#43;00
 * time: 1.2296221256256104
     7     1.998241e&#43;03     8.369980e-01
 * time: 1.3669061660766602
     8     1.998240e&#43;03     2.052405e-02
 * time: 1.532696008682251
     9     1.998240e&#43;03     4.308395e-04
 * time: 1.635606050491333
</pre>



<pre class='hljl'>
<span class='hljl-nf'>coeftable</span><span class='hljl-p'>(</span><span class='hljl-n'>ordinal_res</span><span class='hljl-p'>)</span>
</pre>



<table class="data-frame"><thead><tr><th></th><th>parameter</th><th>estimate</th></tr><tr><th></th><th>String</th><th>Float64</th></tr></thead><tbody><p>5 rows × 2 columns</p><tr><th>1</th><td>b₁</td><td>3.36015</td></tr><tr><th>2</th><td>b₂</td><td>-3.03195</td></tr><tr><th>3</th><td>b₃</td><td>-2.76651</td></tr><tr><th>4</th><td>slope</td><td>-0.434051</td></tr><tr><th>5</th><td>ω</td><td>1.63814</td></tr></tbody></table>

<p>and get the paremter precision with</p>


<pre class='hljl'>
<span class='hljl-n'>ordinal_res</span><span class='hljl-t'> </span><span class='hljl-oB'>|&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>infer</span><span class='hljl-t'> </span><span class='hljl-oB'>|&gt;</span><span class='hljl-t'> </span><span class='hljl-n'>coeftable</span>
</pre>


<pre class="output">
Calculating: variance-covariance matrix. Done.
</pre>


<table class="data-frame"><thead><tr><th></th><th>parameter</th><th>estimate</th><th>se</th><th>ci_lower</th><th>ci_upper</th></tr><tr><th></th><th>String</th><th>Float64</th><th>Float64</th><th>Float64</th><th>Float64</th></tr></thead><tbody><p>5 rows × 5 columns</p><tr><th>1</th><td>b₁</td><td>3.36015</td><td>0.186569</td><td>2.99448</td><td>3.72582</td></tr><tr><th>2</th><td>b₂</td><td>-3.03195</td><td>0.117161</td><td>-3.26158</td><td>-2.80232</td></tr><tr><th>3</th><td>b₃</td><td>-2.76651</td><td>0.106537</td><td>-2.97532</td><td>-2.5577</td></tr><tr><th>4</th><td>slope</td><td>-0.434051</td><td>0.0537037</td><td>-0.539308</td><td>-0.328794</td></tr><tr><th>5</th><td>ω</td><td>1.63814</td><td>0.105916</td><td>1.43054</td><td>1.84573</td></tr></tbody></table>


<pre class='hljl'>
<span class='hljl-k'>using</span><span class='hljl-t'> </span><span class='hljl-n'>PumasTutorials</span>
</pre>


<pre class="julia-error">
ERROR: ArgumentError: Package PumasTutorials not found in current path:
- Run &#96;import Pkg; Pkg.add&#40;&quot;PumasTutorials&quot;&#41;&#96; to install the PumasTutorials package.

</pre>



<pre class='hljl'>
<span class='hljl-n'>PumasTutorials</span><span class='hljl-oB'>.</span><span class='hljl-nf'>tutorial_footer</span><span class='hljl-p'>(</span><span class='hljl-n'>WEAVE_ARGS</span><span class='hljl-p'>[</span><span class='hljl-sc'>:folder</span><span class='hljl-p'>],</span><span class='hljl-n'>WEAVE_ARGS</span><span class='hljl-p'>[</span><span class='hljl-sc'>:file</span><span class='hljl-p'>])</span>
</pre>


<pre class="julia-error">
ERROR: UndefVarError: PumasTutorials not defined
</pre>



        <HR/>
        <div class="footer">
          <p>
            Published from <a href="discrete_response_models.jmd">discrete_response_models.jmd</a>
            using <a href="http://github.com/JunoLab/Weave.jl">Weave.jl</a> v0.10.2 on 2020-06-10.
          </p>
        </div>
      </div>
    </div>
  </div>
</BODY>

</HTML>
